#include "main.hpp"

unsigned char __1_41_0_SaberBlade_fix_glsl[] = {
  0x23, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x20, 0x33, 0x32, 0x30,
  0x20, 0x65, 0x73, 0x0a, 0x23, 0x69, 0x66, 0x6e, 0x64, 0x65, 0x66, 0x20,
  0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f, 0x52, 0x55, 0x4e, 0x54, 0x49, 0x4d,
  0x45, 0x5f, 0x49, 0x4e, 0x53, 0x54, 0x41, 0x4e, 0x43, 0x49, 0x4e, 0x47,
  0x5f, 0x41, 0x52, 0x52, 0x41, 0x59, 0x5f, 0x53, 0x49, 0x5a, 0x45, 0x0a,
  0x09, 0x23, 0x64, 0x65, 0x66, 0x69, 0x6e, 0x65, 0x20, 0x55, 0x4e, 0x49,
  0x54, 0x59, 0x5f, 0x52, 0x55, 0x4e, 0x54, 0x49, 0x4d, 0x45, 0x5f, 0x49,
  0x4e, 0x53, 0x54, 0x41, 0x4e, 0x43, 0x49, 0x4e, 0x47, 0x5f, 0x41, 0x52,
  0x52, 0x41, 0x59, 0x5f, 0x53, 0x49, 0x5a, 0x45, 0x20, 0x32, 0x0a, 0x23,
  0x65, 0x6e, 0x64, 0x69, 0x66, 0x0a, 0x0a, 0x70, 0x72, 0x65, 0x63, 0x69,
  0x73, 0x69, 0x6f, 0x6e, 0x20, 0x68, 0x69, 0x67, 0x68, 0x70, 0x20, 0x66,
  0x6c, 0x6f, 0x61, 0x74, 0x3b, 0x0a, 0x70, 0x72, 0x65, 0x63, 0x69, 0x73,
  0x69, 0x6f, 0x6e, 0x20, 0x68, 0x69, 0x67, 0x68, 0x70, 0x20, 0x69, 0x6e,
  0x74, 0x3b, 0x0a, 0x23, 0x64, 0x65, 0x66, 0x69, 0x6e, 0x65, 0x20, 0x48,
  0x4c, 0x53, 0x4c, 0x43, 0x43, 0x5f, 0x45, 0x4e, 0x41, 0x42, 0x4c, 0x45,
  0x5f, 0x55, 0x4e, 0x49, 0x46, 0x4f, 0x52, 0x4d, 0x5f, 0x42, 0x55, 0x46,
  0x46, 0x45, 0x52, 0x53, 0x20, 0x31, 0x0a, 0x23, 0x69, 0x66, 0x20, 0x48,
  0x4c, 0x53, 0x4c, 0x43, 0x43, 0x5f, 0x45, 0x4e, 0x41, 0x42, 0x4c, 0x45,
  0x5f, 0x55, 0x4e, 0x49, 0x46, 0x4f, 0x52, 0x4d, 0x5f, 0x42, 0x55, 0x46,
  0x46, 0x45, 0x52, 0x53, 0x0a, 0x23, 0x64, 0x65, 0x66, 0x69, 0x6e, 0x65,
  0x20, 0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f, 0x55, 0x4e, 0x49, 0x46, 0x4f,
  0x52, 0x4d, 0x0a, 0x23, 0x65, 0x6c, 0x73, 0x65, 0x0a, 0x23, 0x64, 0x65,
  0x66, 0x69, 0x6e, 0x65, 0x20, 0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f, 0x55,
  0x4e, 0x49, 0x46, 0x4f, 0x52, 0x4d, 0x20, 0x75, 0x6e, 0x69, 0x66, 0x6f,
  0x72, 0x6d, 0x0a, 0x23, 0x65, 0x6e, 0x64, 0x69, 0x66, 0x0a, 0x23, 0x64,
  0x65, 0x66, 0x69, 0x6e, 0x65, 0x20, 0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f,
  0x53, 0x55, 0x50, 0x50, 0x4f, 0x52, 0x54, 0x53, 0x5f, 0x55, 0x4e, 0x49,
  0x46, 0x4f, 0x52, 0x4d, 0x5f, 0x4c, 0x4f, 0x43, 0x41, 0x54, 0x49, 0x4f,
  0x4e, 0x20, 0x31, 0x0a, 0x23, 0x69, 0x66, 0x20, 0x55, 0x4e, 0x49, 0x54,
  0x59, 0x5f, 0x53, 0x55, 0x50, 0x50, 0x4f, 0x52, 0x54, 0x53, 0x5f, 0x55,
  0x4e, 0x49, 0x46, 0x4f, 0x52, 0x4d, 0x5f, 0x4c, 0x4f, 0x43, 0x41, 0x54,
  0x49, 0x4f, 0x4e, 0x0a, 0x23, 0x64, 0x65, 0x66, 0x69, 0x6e, 0x65, 0x20,
  0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f, 0x4c, 0x4f, 0x43, 0x41, 0x54, 0x49,
  0x4f, 0x4e, 0x28, 0x78, 0x29, 0x20, 0x6c, 0x61, 0x79, 0x6f, 0x75, 0x74,
  0x28, 0x6c, 0x6f, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x3d, 0x20,
  0x78, 0x29, 0x0a, 0x23, 0x64, 0x65, 0x66, 0x69, 0x6e, 0x65, 0x20, 0x55,
  0x4e, 0x49, 0x54, 0x59, 0x5f, 0x42, 0x49, 0x4e, 0x44, 0x49, 0x4e, 0x47,
  0x28, 0x78, 0x29, 0x20, 0x6c, 0x61, 0x79, 0x6f, 0x75, 0x74, 0x28, 0x62,
  0x69, 0x6e, 0x64, 0x69, 0x6e, 0x67, 0x20, 0x3d, 0x20, 0x78, 0x2c, 0x20,
  0x73, 0x74, 0x64, 0x31, 0x34, 0x30, 0x29, 0x0a, 0x23, 0x65, 0x6c, 0x73,
  0x65, 0x0a, 0x23, 0x64, 0x65, 0x66, 0x69, 0x6e, 0x65, 0x20, 0x55, 0x4e,
  0x49, 0x54, 0x59, 0x5f, 0x4c, 0x4f, 0x43, 0x41, 0x54, 0x49, 0x4f, 0x4e,
  0x28, 0x78, 0x29, 0x0a, 0x23, 0x64, 0x65, 0x66, 0x69, 0x6e, 0x65, 0x20,
  0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f, 0x42, 0x49, 0x4e, 0x44, 0x49, 0x4e,
  0x47, 0x28, 0x78, 0x29, 0x20, 0x6c, 0x61, 0x79, 0x6f, 0x75, 0x74, 0x28,
  0x73, 0x74, 0x64, 0x31, 0x34, 0x30, 0x29, 0x0a, 0x23, 0x65, 0x6e, 0x64,
  0x69, 0x66, 0x0a, 0x75, 0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x20, 0x09,
  0x76, 0x65, 0x63, 0x34, 0x20, 0x5f, 0x54, 0x69, 0x6d, 0x65, 0x3b, 0x0a,
  0x75, 0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x20, 0x09, 0x69, 0x6e, 0x74,
  0x20, 0x75, 0x6e, 0x69, 0x74, 0x79, 0x5f, 0x42, 0x61, 0x73, 0x65, 0x49,
  0x6e, 0x73, 0x74, 0x61, 0x6e, 0x63, 0x65, 0x49, 0x44, 0x3b, 0x0a, 0x75,
  0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x20, 0x09, 0x76, 0x65, 0x63, 0x34,
  0x20, 0x5f, 0x4d, 0x61, 0x69, 0x6e, 0x54, 0x65, 0x78, 0x5f, 0x53, 0x54,
  0x3b, 0x0a, 0x75, 0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x20, 0x09, 0x6d,
  0x65, 0x64, 0x69, 0x75, 0x6d, 0x70, 0x20, 0x76, 0x65, 0x63, 0x32, 0x20,
  0x5f, 0x4d, 0x61, 0x69, 0x6e, 0x54, 0x65, 0x78, 0x53, 0x70, 0x65, 0x65,
  0x64, 0x3b, 0x0a, 0x75, 0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x20, 0x09,
  0x6d, 0x65, 0x64, 0x69, 0x75, 0x6d, 0x70, 0x20, 0x66, 0x6c, 0x6f, 0x61,
  0x74, 0x20, 0x5f, 0x42, 0x72, 0x69, 0x67, 0x68, 0x74, 0x6e, 0x65, 0x73,
  0x73, 0x3b, 0x0a, 0x75, 0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x20, 0x09,
  0x76, 0x65, 0x63, 0x34, 0x20, 0x5f, 0x54, 0x69, 0x6d, 0x65, 0x48, 0x65,
  0x6c, 0x70, 0x65, 0x72, 0x4f, 0x66, 0x66, 0x73, 0x65, 0x74, 0x3b, 0x0a,
  0x73, 0x74, 0x72, 0x75, 0x63, 0x74, 0x20, 0x50, 0x72, 0x6f, 0x70, 0x73,
  0x41, 0x72, 0x72, 0x61, 0x79, 0x5f, 0x54, 0x79, 0x70, 0x65, 0x20, 0x7b,
  0x0a, 0x09, 0x6d, 0x65, 0x64, 0x69, 0x75, 0x6d, 0x70, 0x20, 0x76, 0x65,
  0x63, 0x34, 0x20, 0x5f, 0x54, 0x69, 0x6e, 0x74, 0x43, 0x6f, 0x6c, 0x6f,
  0x72, 0x3b, 0x0a, 0x7d, 0x3b, 0x0a, 0x23, 0x69, 0x66, 0x20, 0x48, 0x4c,
  0x53, 0x4c, 0x43, 0x43, 0x5f, 0x45, 0x4e, 0x41, 0x42, 0x4c, 0x45, 0x5f,
  0x55, 0x4e, 0x49, 0x46, 0x4f, 0x52, 0x4d, 0x5f, 0x42, 0x55, 0x46, 0x46,
  0x45, 0x52, 0x53, 0x0a, 0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f, 0x42, 0x49,
  0x4e, 0x44, 0x49, 0x4e, 0x47, 0x28, 0x30, 0x29, 0x20, 0x75, 0x6e, 0x69,
  0x66, 0x6f, 0x72, 0x6d, 0x20, 0x55, 0x6e, 0x69, 0x74, 0x79, 0x49, 0x6e,
  0x73, 0x74, 0x61, 0x6e, 0x63, 0x69, 0x6e, 0x67, 0x5f, 0x50, 0x72, 0x6f,
  0x70, 0x73, 0x20, 0x7b, 0x0a, 0x23, 0x65, 0x6e, 0x64, 0x69, 0x66, 0x0a,
  0x09, 0x55, 0x4e, 0x49, 0x54, 0x59, 0x5f, 0x55, 0x4e, 0x49, 0x46, 0x4f,
  0x52, 0x4d, 0x20, 0x50, 0x72, 0x6f, 0x70, 0x73, 0x41, 0x72, 0x72, 0x61,
  0x79, 0x5f, 0x54, 0x79, 0x70, 0x65, 0x20, 0x50, 0x72, 0x6f, 0x70, 0x73,
  0x41, 0x72, 0x72, 0x61, 0x79, 0x5b, 0x31, 0x32, 0x38, 0x5d, 0x3b, 0x0a,
  0x23, 0x69, 0x66, 0x20, 0x48, 0x4c, 0x53, 0x4c, 0x43, 0x43, 0x5f, 0x45,
  0x4e, 0x41, 0x42, 0x4c, 0x45, 0x5f, 0x55, 0x4e, 0x49, 0x46, 0x4f, 0x52,
  0x4d, 0x5f, 0x42, 0x55, 0x46, 0x46, 0x45, 0x52, 0x53, 0x0a, 0x7d, 0x3b,
  0x0a, 0x23, 0x65, 0x6e, 0x64, 0x69, 0x66, 0x0a, 0x55, 0x4e, 0x49, 0x54,
  0x59, 0x5f, 0x4c, 0x4f, 0x43, 0x41, 0x54, 0x49, 0x4f, 0x4e, 0x28, 0x30,
  0x29, 0x20, 0x75, 0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x20, 0x6d, 0x65,
  0x64, 0x69, 0x75, 0x6d, 0x70, 0x20, 0x73, 0x61, 0x6d, 0x70, 0x6c, 0x65,
  0x72, 0x32, 0x44, 0x20, 0x5f, 0x4d, 0x61, 0x69, 0x6e, 0x54, 0x65, 0x78,
  0x3b, 0x0a, 0x69, 0x6e, 0x20, 0x68, 0x69, 0x67, 0x68, 0x70, 0x20, 0x76,
  0x65, 0x63, 0x32, 0x20, 0x76, 0x73, 0x5f, 0x54, 0x45, 0x58, 0x43, 0x4f,
  0x4f, 0x52, 0x44, 0x30, 0x3b, 0x0a, 0x69, 0x6e, 0x20, 0x68, 0x69, 0x67,
  0x68, 0x70, 0x20, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x20, 0x76, 0x73, 0x5f,
  0x54, 0x45, 0x58, 0x43, 0x4f, 0x4f, 0x52, 0x44, 0x31, 0x3b, 0x0a, 0x66,
  0x6c, 0x61, 0x74, 0x20, 0x69, 0x6e, 0x20, 0x68, 0x69, 0x67, 0x68, 0x70,
  0x20, 0x75, 0x69, 0x6e, 0x74, 0x20, 0x76, 0x73, 0x5f, 0x53, 0x56, 0x5f,
  0x49, 0x6e, 0x73, 0x74, 0x61, 0x6e, 0x63, 0x65, 0x49, 0x44, 0x30, 0x3b,
  0x0a, 0x6c, 0x61, 0x79, 0x6f, 0x75, 0x74, 0x28, 0x6c, 0x6f, 0x63, 0x61,
  0x74, 0x69, 0x6f, 0x6e, 0x20, 0x3d, 0x20, 0x30, 0x29, 0x20, 0x6f, 0x75,
  0x74, 0x20, 0x6d, 0x65, 0x64, 0x69, 0x75, 0x6d, 0x70, 0x20, 0x76, 0x65,
  0x63, 0x34, 0x20, 0x53, 0x56, 0x5f, 0x54, 0x61, 0x72, 0x67, 0x65, 0x74,
  0x30, 0x3b, 0x0a, 0x76, 0x65, 0x63, 0x34, 0x20, 0x75, 0x5f, 0x78, 0x6c,
  0x61, 0x74, 0x30, 0x3b, 0x0a, 0x6d, 0x65, 0x64, 0x69, 0x75, 0x6d, 0x70,
  0x20, 0x66, 0x6c, 0x6f, 0x61, 0x74, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61,
  0x74, 0x31, 0x36, 0x5f, 0x30, 0x3b, 0x0a, 0x6d, 0x65, 0x64, 0x69, 0x75,
  0x6d, 0x70, 0x20, 0x76, 0x65, 0x63, 0x34, 0x20, 0x75, 0x5f, 0x78, 0x6c,
  0x61, 0x74, 0x31, 0x36, 0x5f, 0x31, 0x3b, 0x0a, 0x76, 0x65, 0x63, 0x34,
  0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x32, 0x3b, 0x0a, 0x66, 0x6c,
  0x6f, 0x61, 0x74, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x33, 0x3b,
  0x0a, 0x76, 0x65, 0x63, 0x32, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74,
  0x36, 0x3b, 0x0a, 0x69, 0x6e, 0x74, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61,
  0x74, 0x69, 0x36, 0x3b, 0x0a, 0x76, 0x6f, 0x69, 0x64, 0x20, 0x6d, 0x61,
  0x69, 0x6e, 0x28, 0x29, 0x0a, 0x7b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75,
  0x5f, 0x78, 0x6c, 0x61, 0x74, 0x30, 0x2e, 0x78, 0x20, 0x3d, 0x20, 0x5f,
  0x54, 0x69, 0x6d, 0x65, 0x2e, 0x78, 0x20, 0x2b, 0x20, 0x5f, 0x54, 0x69,
  0x6d, 0x65, 0x48, 0x65, 0x6c, 0x70, 0x65, 0x72, 0x4f, 0x66, 0x66, 0x73,
  0x65, 0x74, 0x2e, 0x78, 0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f,
  0x78, 0x6c, 0x61, 0x74, 0x30, 0x2e, 0x78, 0x79, 0x20, 0x3d, 0x20, 0x75,
  0x5f, 0x78, 0x6c, 0x61, 0x74, 0x30, 0x2e, 0x78, 0x78, 0x20, 0x2a, 0x20,
  0x5f, 0x4d, 0x61, 0x69, 0x6e, 0x54, 0x65, 0x78, 0x53, 0x70, 0x65, 0x65,
  0x64, 0x2e, 0x78, 0x79, 0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f,
  0x78, 0x6c, 0x61, 0x74, 0x36, 0x2e, 0x78, 0x79, 0x20, 0x3d, 0x20, 0x76,
  0x73, 0x5f, 0x54, 0x45, 0x58, 0x43, 0x4f, 0x4f, 0x52, 0x44, 0x30, 0x2e,
  0x78, 0x79, 0x20, 0x2a, 0x20, 0x5f, 0x4d, 0x61, 0x69, 0x6e, 0x54, 0x65,
  0x78, 0x5f, 0x53, 0x54, 0x2e, 0x78, 0x79, 0x20, 0x2b, 0x20, 0x5f, 0x4d,
  0x61, 0x69, 0x6e, 0x54, 0x65, 0x78, 0x5f, 0x53, 0x54, 0x2e, 0x7a, 0x77,
  0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74,
  0x30, 0x2e, 0x78, 0x79, 0x20, 0x3d, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61,
  0x74, 0x30, 0x2e, 0x78, 0x79, 0x20, 0x2a, 0x20, 0x5f, 0x4d, 0x61, 0x69,
  0x6e, 0x54, 0x65, 0x78, 0x5f, 0x53, 0x54, 0x2e, 0x78, 0x79, 0x20, 0x2b,
  0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x36, 0x2e, 0x78, 0x79, 0x3b,
  0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31,
  0x36, 0x5f, 0x30, 0x20, 0x3d, 0x20, 0x74, 0x65, 0x78, 0x74, 0x75, 0x72,
  0x65, 0x28, 0x5f, 0x4d, 0x61, 0x69, 0x6e, 0x54, 0x65, 0x78, 0x2c, 0x20,
  0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x30, 0x2e, 0x78, 0x79, 0x29, 0x2e,
  0x78, 0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61,
  0x74, 0x33, 0x20, 0x3d, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31,
  0x36, 0x5f, 0x30, 0x20, 0x2a, 0x20, 0x5f, 0x42, 0x72, 0x69, 0x67, 0x68,
  0x74, 0x6e, 0x65, 0x73, 0x73, 0x20, 0x2b, 0x20, 0x76, 0x73, 0x5f, 0x54,
  0x45, 0x58, 0x43, 0x4f, 0x4f, 0x52, 0x44, 0x31, 0x3b, 0x0a, 0x20, 0x20,
  0x20, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x69, 0x36, 0x20, 0x3d,
  0x20, 0x69, 0x6e, 0x74, 0x28, 0x76, 0x73, 0x5f, 0x53, 0x56, 0x5f, 0x49,
  0x6e, 0x73, 0x74, 0x61, 0x6e, 0x63, 0x65, 0x49, 0x44, 0x30, 0x29, 0x20,
  0x2b, 0x20, 0x75, 0x6e, 0x69, 0x74, 0x79, 0x5f, 0x42, 0x61, 0x73, 0x65,
  0x49, 0x6e, 0x73, 0x74, 0x61, 0x6e, 0x63, 0x65, 0x49, 0x44, 0x3b, 0x0a,
  0x20, 0x20, 0x20, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31, 0x36,
  0x5f, 0x31, 0x2e, 0x78, 0x79, 0x7a, 0x20, 0x3d, 0x20, 0x76, 0x65, 0x63,
  0x33, 0x28, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31, 0x36, 0x5f, 0x30,
  0x29, 0x20, 0x2a, 0x20, 0x76, 0x65, 0x63, 0x33, 0x28, 0x76, 0x65, 0x63,
  0x33, 0x28, 0x5f, 0x42, 0x72, 0x69, 0x67, 0x68, 0x74, 0x6e, 0x65, 0x73,
  0x73, 0x2c, 0x20, 0x5f, 0x42, 0x72, 0x69, 0x67, 0x68, 0x74, 0x6e, 0x65,
  0x73, 0x73, 0x2c, 0x20, 0x5f, 0x42, 0x72, 0x69, 0x67, 0x68, 0x74, 0x6e,
  0x65, 0x73, 0x73, 0x29, 0x29, 0x20, 0x2b, 0x20, 0x50, 0x72, 0x6f, 0x70,
  0x73, 0x41, 0x72, 0x72, 0x61, 0x79, 0x5b, 0x75, 0x5f, 0x78, 0x6c, 0x61,
  0x74, 0x69, 0x36, 0x5d, 0x2e, 0x5f, 0x54, 0x69, 0x6e, 0x74, 0x43, 0x6f,
  0x6c, 0x6f, 0x72, 0x2e, 0x78, 0x79, 0x7a, 0x3b, 0x0a, 0x20, 0x20, 0x20,
  0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31, 0x36, 0x5f, 0x31, 0x2e,
  0x78, 0x79, 0x7a, 0x20, 0x3d, 0x20, 0x63, 0x6c, 0x61, 0x6d, 0x70, 0x28,
  0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31, 0x36, 0x5f, 0x31, 0x2e, 0x78,
  0x79, 0x7a, 0x2c, 0x20, 0x30, 0x2e, 0x30, 0x2c, 0x20, 0x31, 0x2e, 0x30,
  0x29, 0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61,
  0x74, 0x31, 0x36, 0x5f, 0x31, 0x2e, 0x77, 0x20, 0x3d, 0x20, 0x30, 0x2e,
  0x30, 0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61,
  0x74, 0x31, 0x36, 0x5f, 0x31, 0x2e, 0x77, 0x20, 0x3d, 0x20, 0x63, 0x6c,
  0x61, 0x6d, 0x70, 0x28, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31, 0x36,
  0x5f, 0x31, 0x2e, 0x77, 0x2c, 0x20, 0x30, 0x2e, 0x30, 0x2c, 0x20, 0x31,
  0x2e, 0x30, 0x29, 0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x75, 0x5f, 0x78,
  0x6c, 0x61, 0x74, 0x32, 0x20, 0x3d, 0x20, 0x28, 0x2d, 0x75, 0x5f, 0x78,
  0x6c, 0x61, 0x74, 0x31, 0x36, 0x5f, 0x31, 0x29, 0x20, 0x2b, 0x20, 0x50,
  0x72, 0x6f, 0x70, 0x73, 0x41, 0x72, 0x72, 0x61, 0x79, 0x5b, 0x75, 0x5f,
  0x78, 0x6c, 0x61, 0x74, 0x69, 0x36, 0x5d, 0x2e, 0x5f, 0x54, 0x69, 0x6e,
  0x74, 0x43, 0x6f, 0x6c, 0x6f, 0x72, 0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20,
  0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x30, 0x20, 0x3d, 0x20, 0x76, 0x65,
  0x63, 0x34, 0x28, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x33, 0x29, 0x20,
  0x2a, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x32, 0x20, 0x2b, 0x20,
  0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x31, 0x36, 0x5f, 0x31, 0x3b, 0x0a,
  0x20, 0x20, 0x20, 0x20, 0x53, 0x56, 0x5f, 0x54, 0x61, 0x72, 0x67, 0x65,
  0x74, 0x30, 0x20, 0x3d, 0x20, 0x75, 0x5f, 0x78, 0x6c, 0x61, 0x74, 0x30,
  0x3b, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x72, 0x65, 0x74, 0x75, 0x72, 0x6e,
  0x3b, 0x0a, 0x7d, 0x0
};
unsigned int __1_41_0_SaberBlade_fix_glsl_len = 2116;

#include "beatsaber-hook/shared/utils/hooking.hpp"
#include "beatsaber-hook/shared/utils/il2cpp-functions.hpp"
#include "beatsaber-hook/shared/utils/typedefs.h"
#include "logger.hpp"
#include "modInfo.hpp"
#include "scotland2/shared/modloader.h"
#include <cmath>
#include <cstddef>
#include <cstdint>

struct float3 {
    float x;
    float y;
    float z;
};

struct RoomSettings {
    float3 center;
    float rotation;
};

struct SelectedProfile {
    // bool
    int builtIn;
    int index;
};

struct ControllerSettings
{
     float3 position; //Field offset: 0x0
     float3 rotation; //Field offset: 0xC
     // bool
     int hapticFeedback; //Field offset: 0x18
     SelectedProfile selectedProfile; //Field offset: 0x1C
};

struct AudioSettings
{
  float volume; //Field offset: 0x0
  float ambientVolumeScale; //Field offset: 0x4
  float latency; //Field offset: 0x8
  int overrideLatency; //Field offset: 0xC
};

struct MiscSettings
{
    enum ResponseLevel
    {
        Instant = 0,
        Long = 1,
    };

    Il2CppString* language; //Field offset: 0x0
    ResponseLevel pauseButtonResponse; //Field offset: 0x8
};


struct SmoothCameraSettings
{
 int enabled; //Field offset: 0x0
 float fov; //Field offset: 0x4
 float smoothPosition; //Field offset: 0x8
 float smoothRotation; //Field offset: 0xC
 int thirdPersonEnabled; //Field offset: 0x10
 float3 thirdPersonPosition; //Field offset: 0x14
 float3 thirdPersonRotation; //Field offset: 0x20
};

struct QualitySettings
{
     enum BloomQuality
    {
        Game = 0,
        LightBaking = 1,
    };

    enum MainEffectOption
    {
        Off = 0,
        Game_ = 1,
        LightBaking_ = 2,
    };
    enum MirrorQuality
    {
        Off_ = 0,
        Low = 1,
        Medium = 2,
        High = 3,
    };

     enum ObstacleQuality
    {
        Low_ = 0,
        Medium_ = 1,
        High_ = 2,
    };

  float renderViewportScale; //Field offset: 0x0
  float vrResolutionScale; //Field offset: 0x4
  float menuVRResolutionScaleMultiplier; //Field offset: 0x8
  int antiAliasingLevel; //Field offset: 0xC
  int targetFramerate; //Field offset: 0x10
  int vSyncCount; //Field offset: 0x14
  int maxQueuedFrames; //Field offset: 0x18
  MainEffectOption mainEffect; //Field offset: 0x1C
  BloomQuality bloom; //Field offset: 0x20
  MirrorQuality mirror; //Field offset: 0x24
  ObstacleQuality obstacles; //Field offset: 0x28
  bool screenDisplacementEffects; //Field offset: 0x2C
  bool smokeGraphics; //Field offset: 0x2D
  bool depthTexture; //Field offset: 0x2E
  bool burnMarkTrails; //Field offset: 0x2F
  int maxShockwaveParticles; //Field offset: 0x30
  int maxNumberOfCutSoundEffects; //Field offset: 0x34
};

struct QuestSettings {
    enum FoveatedRenderingLevel
    {
        Off = 0,
        Low = 1,
        Medium = 2,
        High = 3,
        HighTop = 4,
    };

    enum SuggestedPerformanceLevel
    {
        Default = 0,
        PowerSavings = 1,
        SustainedLow = 2,
        SustainedHigh = 3,
        Boost = 4,
    };

    SuggestedPerformanceLevel cpuLevel; //Field offset: 0x0
    SuggestedPerformanceLevel gpuLevel; //Field offset: 0x4
    FoveatedRenderingLevel foveatedRenderingMenu; //Field offset: 0x8
    FoveatedRenderingLevel foveatedRenderingGameplay; //Field offset: 0xC
    bool eyeTrackedFoveatedRendering; //Field offset: 0x10
    bool dynamicFoveatedRendering; //Field offset: 0x11
};

struct int2 {
 int x; //Field offset: 0x0
 int y; //Field offset: 0x4
};

struct WindowSettings {
    bool fullscreen; //Field offset: 0x0
    int2 resolution; //Field offset: 0x4
};

struct CustomServerSettings {
    bool useCustomEnvironment;
    bool forceGameLiftEnvironment; //Field offset: 0x1
    StringW hostName;
};

struct PerformanceToolSettings {
    bool recordFps; //Field offset: 0x0
    bool showFps; //Field offset: 0x1
    bool showMemory; //Field offset: 0x2
    bool saveScreenshot; //Field offset: 0x3
};

struct DebugSettings {
    bool showBeatmapLevelVersion; //Field offset: 0x0
    bool disableVRTrackingInAutoplayPS4; //Field offset: 0x1
};

struct Settings {
    RoomSettings room;
    ControllerSettings controller;
    SmoothCameraSettings smoothCamera;
    AudioSettings audioSettings;
    MiscSettings misc;
    QualitySettings quality;
    QuestSettings quest;
    WindowSettings windows;
    CustomServerSettings customServer;
    PerformanceToolSettings performanceTools;
    DebugSettings debug;
};


DEFINE_IL2CPP_ARG_TYPE(Settings, "BeatSaber.Settings", "Settings");
struct GameObject : Il2CppObject {};
struct String : StringW {};
struct BoolSO : Il2CppObject {};
struct Renderer : Il2CppObject {};
struct Material : Il2CppObject {};
struct SystemBool {
    bool m_value;
};

struct Behaviour : Il2CppObject{};
struct MonoBehaviour : Behaviour{};
struct ImageEffectController : MonoBehaviour{};
struct MainEffectContainerSO : Il2CppObject{};
struct MainEffectSO : Il2CppObject{};
struct PyramidBloomMainEffectSO : MainEffectSO{};
struct MainEffectCore{};

struct AllocationRootWithSalt
{
    unsigned m_Salt;
    unsigned m_RootReferenceIndex;
};


struct StackAllocated {
    char data[31];
    char flags;
};

struct HeapAllocated {
public:
    const char* data; // 0x0
    __int64_t capacity; // 0x8
    __int64_t size; // 0x10
    char padding[7]; // padding
    char flags; // 31
};

namespace core
{
    class basic_string
    {
    public:
        basic_string() = default;

        union
        {
            StackAllocated embedded;
            HeapAllocated heap;
        };

     char const* c_str() const {
         if (this->heap.flags < 0x40) {
             return this->embedded.data;
         }

         return this->heap.data;
     }
    };
};




DEFINE_IL2CPP_ARG_TYPE(GameObject*, "UnityEngine", "GameObject");
DEFINE_IL2CPP_ARG_TYPE(String*, "System", "String");
DEFINE_IL2CPP_ARG_TYPE(BoolSO*, "", "BoolSO");
DEFINE_IL2CPP_ARG_TYPE(SystemBool, "System", "Boolean");
DEFINE_IL2CPP_ARG_TYPE(Renderer*, "UnityEngine", "Renderer");
DEFINE_IL2CPP_ARG_TYPE(Material*, "UnityEngine", "Material");
DEFINE_IL2CPP_ARG_TYPE(ImageEffectController*, "", "ImageEffectController");
DEFINE_IL2CPP_ARG_TYPE(MainEffectContainerSO*, "", "MainEffectContainerSO");
DEFINE_IL2CPP_ARG_TYPE(MainEffectSO*, "", "MainEffectSO");
DEFINE_IL2CPP_ARG_TYPE(MainEffectCore*, "", "MainEffectCore");
DEFINE_IL2CPP_ARG_TYPE(PyramidBloomMainEffectSO*, "", "PyramidBloomMainEffectSO");
DEFINE_IL2CPP_ARG_TYPE(MonoBehaviour*, "UnityEngine", "MonoBehaviour");
DEFINE_IL2CPP_ARG_TYPE(Behaviour*, "UnityEngine", "Behaviour");

MAKE_HOOK_FIND_CLASS_UNSAFE_STATIC(MainEffectCore_SetGlobalShaderValues, "", "MainEffectCore", "SetGlobalShaderValues", void, float baseColorBoost, float baseColorBoostThreshold) {
    //baseColorBoost = 0.15f;
    //baseColorBoostThreshold = 0.0f;
    MainEffectCore_SetGlobalShaderValues(baseColorBoost, baseColorBoostThreshold);
}


MAKE_HOOK_FIND_CLASS_UNSAFE_INSTANCE(MainEffectController_OnPreRender, "", "MainEffectController", "OnPreRender", void, Il2CppObject* self) {
    auto imageEffectController = *il2cpp_utils::GetFieldValue<ImageEffectController*>(self, "_imageEffectController");
    auto _mainEffectContainer = *il2cpp_utils::GetFieldValue<MainEffectContainerSO*>(self, "_mainEffectContainer");
    auto mainEffect = *il2cpp_utils::GetFieldValue<MainEffectSO*>(_mainEffectContainer, "_mainEffect");
    il2cpp_utils::RunMethod<void>(mainEffect, "PreRender");
    il2cpp_utils::SetPropertyValue(imageEffectController, "enabled", true);
    auto value = SystemBool{true};
    il2cpp_utils::RunMethod<void>(reinterpret_cast<MainEffectCore*>(il2cpp_utils::GetClassFromName("", "MainEffectCore")), "UpdateKeyword", value);
}

MAKE_HOOK_FIND_CLASS_UNSAFE_INSTANCE(SettingsApplicatorSO_ApplyGraphicSettings, "", "SettingsApplicatorSO", "ApplyGraphicSettings", void, Il2CppObject* self, Settings settings, int other) {
    settings.quality.mainEffect = QualitySettings::Game_;
    settings.quality.bloom = QualitySettings::Game;
    settings.quality.obstacles = QualitySettings::High_;
    settings.quality.smokeGraphics = true;
    settings.quality.screenDisplacementEffects = true;
    settings.quality.maxShockwaveParticles = 2;
    settings.quality.burnMarkTrails = true;
    settings.quality.depthTexture = true;
    settings.quality.mirror = QualitySettings::High;
    settings.quality.antiAliasingLevel = 0;
    SettingsApplicatorSO_ApplyGraphicSettings(self, settings, other);
}

MAKE_HOOK_FIND_CLASS_UNSAFE_STATIC(SettingValidations_AdjustQuest3, "BeatSaber.Settings", "SettingValidations", "AdjustQuest3", void, Settings* settings) {
    //SettingValidations_AdjustQuest3(settings);
    settings->quality.mainEffect = QualitySettings::Game_;
    settings->quality.bloom = QualitySettings::Game;
    settings->quality.obstacles = QualitySettings::High_;
    settings->quality.smokeGraphics = true;
    settings->quality.screenDisplacementEffects = true;
    settings->quality.maxShockwaveParticles = 2;
    settings->quality.burnMarkTrails = true;
    settings->quality.depthTexture = true;
    settings->quality.mirror = QualitySettings::High;
    settings->quality.antiAliasingLevel = 0;
}

MAKE_HOOK_FIND_CLASS_UNSAFE_INSTANCE(GraphicSettingsConditionalActivator_GetGraphicsActivatorType, "", "GraphicSettingsConditionalActivator", "Start", bool, Il2CppObject* self) {
    Logger.info("GraphicsSettingsConditional Start");
    auto gameObject = *il2cpp_utils::RunMethod<GameObject*>(self, "get_gameObject").as_optional_result().value_or(nullptr);
    auto name = *il2cpp_utils::GetPropertyValue<String*>(gameObject, "name").as_optional_result().value_or(nullptr);
    auto name2 = il2cpp_utils::detail::to_string(static_cast<StringW>(name));
    Logger.info("GraphicsSettingsConditional END: {}", name2);

    return true;
}

MAKE_HOOK_FIND_CLASS_UNSAFE_INSTANCE(ObstacleController_InitGraphics, "", "ObstacleController", "InitGraphics", void, Il2CppObject* self, Settings settings) {
    settings.quality.screenDisplacementEffects = true;
    ObstacleController_InitGraphics(self, settings);
}

MAKE_HOOK_FIND_CLASS_UNSAFE_INSTANCE(ConditionalMaterialSwitcher_Awake, "", "ConditionalMaterialSwitcher", "Awake", void, Il2CppObject* self) {
    auto gameObject = *il2cpp_utils::RunMethod<GameObject*>(self, "get_gameObject").as_optional_result().value_or(nullptr);

    if (gameObject == nullptr) {
        Logger.info("Nullptr found!");
        ConditionalMaterialSwitcher_Awake(self);
        return;
    }

    auto name = *il2cpp_utils::GetPropertyValue<String*>(gameObject, "name").as_optional_result().value_or(nullptr);

    if (name == nullptr) {
        Logger.info("no name string found!");
        ConditionalMaterialSwitcher_Awake(self);
        return;
    }

    auto valueBool = *il2cpp_utils::GetFieldValue<BoolSO*>(self, "_value").value_or(nullptr);
    auto value = *il2cpp_utils::GetPropertyValue<SystemBool, false>(valueBool, "value").as_optional_result().value_or(nullptr);

    auto name2 = il2cpp_utils::detail::to_string(static_cast<StringW>(name));

    if (name2 == "NoteCube" || name2 == "NoteArrow" || name2 == "SaberGlowingEdges" || name2 == "ObstacleFrame" || name2 == "SaberTrailRendererHologram(Clone)")  {
        value.m_value = true;
        il2cpp_utils::SetPropertyValue<false>(valueBool, "value", value);
    }

    ConditionalMaterialSwitcher_Awake(self);
}

MAKE_HOOK_FIND_CLASS_UNSAFE_INSTANCE(ConditionalActivation_Awake, "", "ConditionalActivation", "Awake", void, Il2CppObject* self) {
    auto gameObject = *il2cpp_utils::GetPropertyValue<GameObject*>(self, "gameObject").as_optional_result().value_or(nullptr);
    auto name = *il2cpp_utils::GetPropertyValue<String*>(gameObject, "name").as_optional_result().value_or(nullptr);
    auto valueBool = *il2cpp_utils::GetFieldValue<BoolSO*>(self, "_value").value_or(nullptr);
    auto value = *il2cpp_utils::GetPropertyValue<SystemBool>(valueBool, "value").as_optional_result().value_or(nullptr);
    auto name2 = il2cpp_utils::detail::to_string(static_cast<StringW>(name));

    if ( name2 == "ObstacleFrame")  {
        value.m_value = true;
        il2cpp_utils::SetPropertyValue(valueBool, "value", value);
    }

    ConditionalActivation_Awake(self);
}

MAKE_HOOK(hGlslGpuProgramGLES_CompileProgramImpl, nullptr, void,
    unsigned int& unknown,
    core::basic_string const& shaderName,
    core::basic_string const* vertex,
    core::basic_string& fragment,
    core::basic_string const& geometry,
    core::basic_string const& hull,
    core::basic_string const& domain,
    int& shader, int a, int * b, int *c, int* d) {
    auto shaderName_cstr = shaderName.c_str();
    Logger.info("CompileProgramImpl title: {}", shaderName_cstr);
    Logger.info("CompileProgramImpl fragment: {} - {} - {} - {}", fragment.c_str(), fragment.heap.size, fragment.heap.capacity, (void*)fragment.heap.data);
    Logger.info("");


    if (strcmp(shaderName_cstr, "Custom/SaberBlade") == 0 && fragment.heap.size == 2188) {
        memcpy((void*)fragment.heap.data, (void*)&__1_41_0_SaberBlade_fix_glsl, __1_41_0_SaberBlade_fix_glsl_len);
        fragment.heap.size = __1_41_0_SaberBlade_fix_glsl_len-1;
    }


    hGlslGpuProgramGLES_CompileProgramImpl(unknown, shaderName, vertex, fragment, geometry, hull, domain, shader, a, b, c, d);
}

/// @brief Called at the early stages of game loading
/// @param info The mod info.  Update this with your mod's info.
/// @return
MOD_EXPORT_FUNC void setup(CModInfo& info) {
    // Convert the mod info to a C struct and set that as the modloader info.
    info = modInfo.to_c();

    Logger.info("Completed setup!");
}

/// @brief Called early on in the game loading
/// @return
MOD_EXPORT_FUNC void load() {
    // Initialize il2cpp functions
    Logger.info("libunity.so start: {}", modloader_unity_handle);
    if(modloader_unity_handle) {
        auto jniOnUnload = dlsym(modloader_unity_handle, "JNI_OnUnload");
        Logger.info("libunity.so yes: {}", (void*)jniOnUnload);
        auto GlslGpuProgramGLES_CompileProgramImpl =  (char*)jniOnUnload + 0x6E8EE0;
        Logger.info("GlslGpuProgramGLES_CompileProgramImpl {}", (void*)GlslGpuProgramGLES_CompileProgramImpl);
        if(GlslGpuProgramGLES_CompileProgramImpl)
            INSTALL_HOOK_DIRECT(Logger, hGlslGpuProgramGLES_CompileProgramImpl, reinterpret_cast<void*>(GlslGpuProgramGLES_CompileProgramImpl));
    }

    il2cpp_functions::Init();
}

/// @brief Called later on in the game loading - a good time to install function hooks
/// @return
MOD_EXPORT_FUNC void late_load() {
    INSTALL_HOOK(Logger, GraphicSettingsConditionalActivator_GetGraphicsActivatorType);
    INSTALL_HOOK(Logger, SettingValidations_AdjustQuest3);
    //INSTALL_HOOK(Logger, ConditionalMaterialSwitcher_Awake);
    //INSTALL_HOOK(Logger, ConditionalActivation_Awake);
    INSTALL_HOOK(Logger, SettingsApplicatorSO_ApplyGraphicSettings);
    INSTALL_HOOK(Logger, ObstacleController_InitGraphics);
    //INSTALL_HOOK(Logger, MainEffectController_OnPreRender);
    INSTALL_HOOK(Logger, MainEffectCore_SetGlobalShaderValues);
}
